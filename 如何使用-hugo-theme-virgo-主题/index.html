<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="如何使用 hugo-theme-virgo 主题 - https://aituyaa.com/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-hugo-theme-virgo-%E4%B8%BB%E9%A2%98/">
    <meta name="author" content="Jack - https://aituyaa.com/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>如何使用 hugo-theme-virgo 主题</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://aituyaa.com/style.min.7a1211384e00d894dc501a9708ae5fb349825c010d5348b62a8727d135f41615.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        
        <div class="cool-before" style="background: url('/imgs/bg/color.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">如何使用 hugo-theme-virgo 主题</h1>
    
        
        
            <div id="toc">📜</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    <div class="rel">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="curtag-desc">
            <a href="https://aituyaa.com/tags/hugo/"><img src="/imgs/icons/tag.svg" width="16" /> 相关文章：Hugo <sup>2</sup></a>
        </div>

        <div class="curtag-post">
            
            
            
                <div class="curtag-post-item ">
                    <a href="https://aituyaa.com/%E4%B8%80%E7%A7%8D%E7%AE%80%E5%8D%95%E7%9A%84-hugo-%E6%9C%AC%E5%9C%B0%E6%90%9C%E7%B4%A2%E5%AE%9E%E7%8E%B0/">一种简单的 Hugo 本地搜索实现</a>
                </div>
                
                
            
            
                <div class="curtag-post-item curtag-post-item--active">
                    <a href="https://aituyaa.com/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-hugo-theme-virgo-%E4%B8%BB%E9%A2%98/">如何使用 hugo-theme-virgo 主题</a>
                </div>
                
                
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2022-05-06&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2025-01-17&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            10437 字</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            21 分钟</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/hugo">Hugo</a>
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#更新日志">更新日志</a></li>
    <li><a href="#简介">简介</a>
      <ul>
        <li><a href="#旧完整版">旧完整版</a></li>
        <li><a href="#新精简版">新精简版</a></li>
      </ul>
    </li>
    <li><a href="#快速开始">快速开始</a>
      <ul>
        <li><a href="#下载主题">下载主题</a></li>
        <li><a href="#站点文件目录结构">站点文件目录结构</a></li>
        <li><a href="#旧完整版注意事项">旧完整版注意事项</a></li>
        <li><a href="#导航页">导航页</a></li>
        <li><a href="#关于搜索">关于搜索</a></li>
        <li><a href="#其他">其他</a></li>
      </ul>
    </li>
    <li><a href="#标记语法增强">标记语法增强</a>
      <ul>
        <li><a href="#行内格式">行内格式</a></li>
        <li><a href="#代码块折叠">代码块折叠</a></li>
        <li><a href="#wiki-链接及图片语法渲染">Wiki 链接及图片语法渲染</a></li>
        <li><a href="#图片渲染相关">图片渲染相关</a></li>
      </ul>
    </li>
    <li><a href="#我的怎么写博客的">我的怎么写博客的</a>
      <ul>
        <li><a href="#准备篇">准备篇</a></li>
        <li><a href="#搭建篇">搭建篇</a></li>
        <li><a href="#编辑篇">编辑篇</a>
          <ul>
            <li><a href="#-使用-vscode-编辑">❌ 使用 VSCode 编辑</a></li>
            <li><a href="#-使用-typora-编辑">❌ 使用 Typora 编辑</a></li>
            <li><a href="#-使用-obsidian-编辑">✔️ 使用 Obsidian 编辑</a></li>
          </ul>
        </li>
        <li><a href="#渲染篇">渲染篇</a></li>
        <li><a href="#部署篇">部署篇</a>
          <ul>
            <li><a href="#脚本部署">脚本部署</a></li>
            <li><a href="#命令简化">命令简化</a></li>
          </ul>
        </li>
        <li><a href="#附录">附录</a>
          <ul>
            <li><a href="#-废弃的部署脚本">❌ 废弃的部署脚本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#结语">结语</a></li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <p><a href="https://themes.gohugo.io/themes/hugo-theme-virgo/">🎨 hugo-theme-virgo</a></p>
<blockquote>
<p><strong>为什么要把使用指南单独列出，而不是放在 README 中？</strong></p>
</blockquote>
<p>一方面，内容更新频繁（虽然没有必要），把更改放在 <code>README</code> 中需要每次都提交主题更新，然而有时候只是单纯的更新 <code>README</code> 而已。</p>
<p>另一方面，国内网络推送到 Github 仓库的时候经常抽风 (如下图)，速度也慢。</p>
<p>![[assets/Pasted image 20230815144943.png]]</p>
<h2 id="更新日志">更新日志</h2>
<pre tabindex="0"><code>- 2025-01-03 14:23 优化并启用站内搜索，使用本地缓存降低性能耗损和加载速度
- 2024-12-03 15:04 添加折叠板功能支持（支持代码块样式和引用块样式）
- 2024-05-09 10:57 [可配置] 导航页增加迷你必应搜索（供导航页向下滚动后仍可快捷搜索）
- 2024-05-08 09:43 优化本地搜索文本内容展示，设置显示最大高度，隐藏滚动条
- 2024-04-29 21:23 [可配置] 集成并优化旧版本地搜索（页面检索）到当前版本
- 2024-04-28 16:08 导航页添加固定链接（Pin）区域，只需在导航链接前添加 &#39;&gt;&#39; 即可生效
- 2024-04-23 19:07 [可配置] 导航页添加顶部搜索栏（原 Ship 页移植）
- 2024-04-22 10:52 除相关文章栏（左）、及目录栏（右），默认在新标签页中打开链接
- 2024-04-19 12:51 [可配置] 文章页新增相关（同标签）系列文章栏（页面左侧区域）
- 2024-03-20 11:38 修复旧完整版本搜索内容不完整的问题，并更新旧版本到分支 1.x
- 2023-09-27 15:12 [可配置] cool 模式下更灵活地配置背景壁纸和遮罩透明度
- 2023-09-21 17:04 [可配置] 恢复 dark 暗色模式（真的不常用），并调整部分图标
- 2023-09-07 16:24 调整 1920*1080 分辨率下样式，正确渲染不以 / 开头的图片
- 2023-08-15 12:21 合并、删除 ob 分支，为功能完整版打标签 v1.0.0
- 2023-08-14 15:46 [可配置] 新增 giscus 评论插件，并默认使用（代替 utterances）
- 2023-08-02 18:31 新增 ob 分支，精简功能，适配 Obsidian
- 2023-03-23 14:58 [可配置] 增加 utterances 评论插件
- 2023-03-22 16:08 更新主页快捷联系选项，增加知乎和简书
- 2023-03-21 17:58 更新导航页面文件结构 - `nav.md` 或 `nav/index.md`
- 2023-03-19 00:05 优化导航页面快速跳转
</code></pre><h2 id="简介">简介</h2>
<p>一个简单纯净的主题，欢迎使用。🎉🎉🎉</p>
<table>
<thead>
<tr>
<th>版本</th>
<th>演示</th>
<th>配置</th>
<th>导航页</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>旧完整版</td>
<td><a href="https://aituyaa.github.io">https://aituyaa.github.io</a></td>
<td> <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/config-old.toml">config-old.toml</a> </td>
<td> <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/nav-old.md">nav-old.md</a> </td>
<td>分支：1.x</td>
</tr>
<tr>
<td>新精简版</td>
<td><a href="https://aituyaa.com">https://aituyaa.com</a></td>
<td> <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/config-new.toml">config-new.toml</a></td>
<td> <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/nav-new.md">nav-new.md</a></td>
<td>分支：master</td>
</tr>
</tbody>
</table>
<p><code>&gt; 版本功能简介</code></p>
<h3 id="旧完整版">旧完整版</h3>
<p>![[assets/Pasted image 20230815105343.png]]</p>
<p>‘她’包含：</p>
<ul>
<li>两种模式：纯净、酷爽，</li>
<li>内置但不限于精美的本地字体，</li>
<li>高亮的层级目录，以及</li>
<li>简单强大的本地文章实时搜索功能等。</li>
</ul>
<h3 id="新精简版">新精简版</h3>
<p>该版本为基于旧版本的<del>精简版</del>简约版本，包含但不限于以下更新：</p>
<ul>
<li>默认移除本地全局搜索功能（可配置添加）；</li>
<li>页面归并改造
<ul>
<li>移除独立的文章页、归档页入口</li>
<li>归档页精简为只显示标签列表（Obsidian 只支持标签），置于首页</li>
<li>更新导航页</li>
</ul>
</li>
<li><del>移除暗色模式（基本没用过）</del> 恢复了，偶尔用</li>
<li>移除相邻文章切换功能（使用不多）</li>
<li>精简了配置项</li>
<li>……</li>
</ul>
<p>![[assets/Snipaste_2024-02-26_16-36-42.png]]</p>
<h2 id="快速开始">快速开始</h2>
<h3 id="下载主题">下载主题</h3>
<p>首先，下载该主题。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 方案一</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> YOUR_SITE_DIR	<span style="color:#998;font-style:italic"># 本地站点目录</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## === 默认拉取新精简版</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/loveminimal/hugo-theme-virgo.git themes/virgo
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## === 若要拉取旧完整版</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## --- 鉴于有一些朋友喜欢旧的版本，为了修复问题方便，新开一个分支 1.x</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## --- ✔️ 所以，你现在可以使用从该分支直接拉取旧版本的最新代码了</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## --- &lt;YOUR_LOCAL_BRANCH&gt; 是你在本地仓库中所使用的分支名称</span>
</span></span><span style="display:flex;"><span>git checkout -b &lt;YOUR_LOCAL_BRANCH&gt; origin/1.x
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## --- 关联本地分支到远程分支（可选）</span>
</span></span><span style="display:flex;"><span>git branch --set-upstream-to<span style="color:#000;font-weight:bold">=</span>origin/1.x &lt;YOUR_LOCAL_BRANCH&gt; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## ❌ 不再推荐从标签拉取，那样你可能会错过一些功能性的修复</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## git clone --branch v1.0.0 https://github.com/loveminimal/hugo-theme-virgo.git themes/virgo</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## git switch -c master</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 方案二</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> YOUR_SITE_DIR
</span></span><span style="display:flex;"><span>git submodule add https://github.com/loveminimal/hugo-theme-virgo.git themes/virgo
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>💡 使用哪种方式呢？如果你有这个疑问，那么就选择第一种方案。</p>
</blockquote>
<p>然后，更新你站点的 <code>config.toml</code> 内容，如下（后续可按需修改）：</p>
<ul>
<li>旧完整版 <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/config-old.toml">config-old.toml</a></li>
<li>新精简版 <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/config-new.toml">config-new.toml</a></li>
</ul>
<p>现在，你就可以进入网站根目录，运行 <code>hugo server -D</code> 开始你的折腾之旅了。</p>
<h3 id="站点文件目录结构">站点文件目录结构</h3>
<pre tabindex="0"><code>jack@jk:~/site$ tree -L 3
.
├── config.toml                                   ;; 站点配置文件
├── content                                       ;; 博文内容
│   ├── assets                                       ;; 博文引用的图片等静态资源
│   │   ├── 1A941H59-0.jpg
│   │   ├── Pasted image 20230525160829.png
│   │   ├── Pasted image 20240828002324.png
│   │   ├── xr-12.gif
│   │   └── ... 
│   ├── snippets                                      ;; Obsidian 中使用的一些插入模板
│   │   ├── frontmatter.md
│   │   ├── longitudinal-management.md
│   │   ├── more.md
│   │   └── ...
│   ├── 00 计算机科学速成课.md                          ;; 博文
│   ├── 01 计算机早期历史.md
│   ├── 01 计算机系统漫游.md
│   ├── 反射与泛型.md
│   ├── 工作                                           ;; 子目录文件夹
│   │   ├── 工作总结.md                                    ;; 子目录博文
│   │   ├── 工作资料.md
│   │   └── ...
│   ├── 文件转换.md                                     ;; 博文
│   ├── 防抖与节流.md
│   ├── 饮食调整.md
│   ├── 马克思主义简览.md
│   └── ...
├── package.json
├── README.md
├── resources                                       ;; Hugo 自动生成的资源
│   └── _gen
│       ├── assets
│       └── images
├── scripts                                         ;; 一些自定义脚本
│   ├── deploy.sh                                      ;; 一键部署脚本
│   ├── server.bat
│   └── serve.sh
├── static                                          ;; 静态资源文件夹
│   ├── emojing                                         ;; 子项目
│   │   ├── assets
│   │   ├── favicon.ico
│   │   ├── imgs
│   │   ├── index.html
│   │   └── README.md
│   ├── imgs                                            ;; 一些图片资源
│   │   ├── bg
│   │   ├── icons
│   │   ├── manyi1.jpg
│   │   ├── manyi.jpg
│   │   ├── me.png
│   │   ├── mygirl.png
│   │   └── us.jpg
│   └── ship                                            ;; 子项目 
│       ├── assets
│       ├── favicon.ico
│       ├── fonts
│       ├── imgs
│       ├── index.html
│       └── README.md
└── themes                                              ;; 主题文件夹
    └── virgo                                              ;; 当前使用主题
        ├── archetypes
        ├── assets
        ├── config
        ├── config.toml
        ├── images
        ├── layouts
        ├── LICENSE
        ├── README.md
        ├── static
        └── theme.toml
</code></pre><h3 id="旧完整版注意事项">旧完整版注意事项</h3>
<p>如同下个小章节 [[#导航页]] 中要提到的，我们需要为几个定制页面建立对应的 <code>*.md</code> 文件，如下：</p>
<table>
<thead>
<tr>
<th>定制页</th>
<th>路由</th>
<th>对应的 md 文件</th>
</tr>
</thead>
<tbody>
<tr>
<td>导航页</td>
<td><code>/nav</code></td>
<td><code>content/nav.md</code></td>
</tr>
<tr>
<td>归档页</td>
<td><code>/archive</code></td>
<td><code>content/archive.md</code></td>
</tr>
<tr>
<td>搜索页</td>
<td><code>/search</code></td>
<td><code>content/search.md</code></td>
</tr>
<tr>
<td>&hellip;</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>其中，相应 <code>*.md</code> 文件中，其 front-mattar 中的 <code>title: </code> 是必需的。实际上，你可以通过以下命令来创建它们：</p>
<pre tabindex="0"><code>hugo new content/nav.md
hugo new content/archive.md
hugo new content/search.md
...
</code></pre><p>除了导航页，其他页面都是没有内容的，创建完成之后即可。关于导航页，为了获得更好的体验，和预览中的样式，请遵循相应的内容格式，详见 [[#导航页]] 中的具体描述。</p>
<h3 id="导航页">导航页</h3>
<p><strong>旧完整版</strong></p>
<p>对于功能完整版，如果，你想使用导航页并正确渲染，那么就应该严格按照这种格式搭建你的 <code>nav.md</code> 文件结构，详见 <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/nav-old.md">nav-old.md</a> 。</p>
<p>为什么要做格式方面的限制呢？</p>
<p>众所周知，Markdown 对 Table 的支持很一般，鉴于导航页的内容主要是外链和书签，使用列表管理是最方便的。另外，我们会使用 JS 进行内容项的统计，所以就需要使用者遵守格式，不然可能页面显示可能会不正常。</p>
<p><strong>新精简版</strong></p>
<p>该版本对于 <code>nav.md</code> 的格式要求就比较宽松，详见 <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/config/nav-new.md">nav-new.md</a> 。</p>
<p><strong>导航页放在哪儿？</strong></p>
<p>放在站点根目录中的  <code>contents/nav.md</code> 即可。</p>
<p>它本质上也是一个博客文件，只不过由于其与常规页面而言有一些定制化，我们在 Front Matter 中定义了 <code>type: nav</code> 来标识它。</p>
<p><strong>对于导航页，我们还做了哪些事情？</strong> 接着往下看。</p>
<h3 id="关于搜索">关于搜索</h3>
<p><strong>移植 Ship 站外搜索</strong></p>
<p>我们把之前定制的<strong>搜索页移植</strong>到了导航页面，并添加了一些动态效果。<a href="https://github.com/loveminimal/ship">loveminimal/ship: A simple search page.</a> 是一个独立的项目，单独部署没有任何问题。之前一直做为子模块嵌在当前主题中，但其风格有时候跟当前主题有些割裂，尤其是当你激活 cool 模式的时候。另外，顶部的快捷导航图标也需要单独维护，尤其是做出更改的时候。</p>
<p>现在，我们直接把它移植过来，可以直接复用 <code>_contact.html</code> 模板页，并允许在 <code>config.toml</code> 配置它。</p>
<p><strong>移植站内搜索</strong></p>
<p>最初我们在新当前版本中是移除了本地搜索的，因为这个功能其实真的不怎么使用，现在加上它也只是因为无聊的很~</p>
<p>既然做了，我们就试图把这个功能做的更好些。我们把旧版本分离式的交互逻辑精简，直接集成在了当前版本的主题中，优化了一些比较耗费性能的触发事件。它不再是一个单独的页面，而是做为一个页面组件插入在导航页的顶部区域。</p>
<p>事实上，导航页是我最常用的页面。</p>
<p><code>&gt; 2025-01-03 14:17</code></p>
<p>鉴于随着站点内容体量不断增加，每次都强制更新搜索内容源缓存是没有必要的。虽然，现代浏览器一般提供了自动缓存功能，但还是在代码层面修改更加完善。本次对于站内搜索做了以下优化：</p>
<ul>
<li>对搜索内容源进行本地缓存（桌面端每天自动更新缓存、移动端每月自动更新缓存）；</li>
<li>且允许通过点击左侧探索图标进行强制拉取更新最新缓存。</li>
</ul>
<h3 id="其他">其他</h3>
<p><strong>提取固定常用链接</strong></p>
<p>我们在 [[导航]] 中使用表格来保存导航链接。尽管我们对其做了分类，但随着链接数量的增加，更快地找到常用链接仍然变成了一个问题，于是增加一个可以固定在顶部的常用导航区域。</p>
<p>为了方便地在导航页编辑和更换固定的链接项，我们在主题文件中 <a href="https://github.com/loveminimal/hugo-theme-virgo/blob/master/assets/js/init/runMisc.js#L20">runMisc.js</a> 中做了一些事情，只需要在导航链接的描述文本前加上 <code>&gt; </code> 符号（见下图），该链接项就会自动固定在顶部区域。</p>
<p><code>&gt; 固定链接的添加示例</code></p>
<p>![[assets/Pasted image 20240429151056.png]]</p>
<p>PS：我们还做了一些“无聊但有趣的事情” 😅，使用 MD5 对链接文本加密，并提取前 6 个字符拼成一个十六进制的颜色值，做为固定链接项的“颜色球”来标识它，所以你会发现不同的链接项，颜色球都是不一样的。</p>
<h2 id="标记语法增强">标记语法增强</h2>
<p><code>&gt; 使用 JS 对 markdown 做出的一些增强性修改</code></p>
<p>不止一次吐槽过 markdown 虽然是纯文本性质的，但是其某些标记语法真的是让人不敢恭维，直观性和表现力都是一般。不过，从另一个方面来说，本来就是轻量级的标记语言，不可能承载太多。</p>
<p>本来想直接修改 markdown 引擎来实现，研究了一下，还要颇费一番工夫。鉴于仅满足于个人使用，用一些曲线方式使用 js 来实现反而更加简单些。</p>
<p>此处就记录一下针对 <code>hugo-theme-virgo</code> 做的一些魔改。</p>
<h3 id="行内格式">行内格式</h3>
<p>Markdown 中的行内格式有以下几种：</p>
<table>
<thead>
<tr>
<th style="text-align:center">语法</th>
<th style="text-align:center">效果</th>
<th style="text-align:center">转译 html 标签</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>**加粗**</code></td>
<td style="text-align:center"><strong>加粗</strong></td>
<td style="text-align:center"><code>&lt;strong&gt;加粗&lt;/strong&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:center"><code>*斜体*</code></td>
<td style="text-align:center"><em>斜体</em></td>
<td style="text-align:center"><code>&lt;em&gt;斜体&lt;/em&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:center"><code>~~删除线~~</code></td>
<td style="text-align:center"><del>删除线</del></td>
<td style="text-align:center"><code>&lt;del&gt;删除线&lt;/del&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">` 行内代码`</td>
<td style="text-align:center"><code>行内代码</code></td>
<td style="text-align:center"><code>&lt;code&gt;行内代码&lt;/code&gt;</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">&mdash;</td>
<td style="text-align:center"><u>下划线</u></td>
<td style="text-align:center"><code>&lt;u&gt;下划线&lt;/u&gt;</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>是的，markdown 中没有下划线的标记语法。</p>
<p>本来想用行内代码的标记格式做魔改，鉴于博文中出现行内的代码的概率较高，遍历起来相对更耗性能（虽然并没有多少），故决定选择 <code>*斜体*</code> 语法标记，其使用频率不多，且其对应的 Org Mode 中可以直接显为粗体显示。</p>
<table>
<thead>
<tr>
<th style="text-align:center">新增语法</th>
<th style="text-align:center">效果</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>*_下划线*</code></td>
<td style="text-align:center"><em>_下划线</em></td>
</tr>
<tr>
<td style="text-align:center"><code>*=高亮*</code></td>
<td style="text-align:center"><em>=高亮</em></td>
</tr>
</tbody>
</table>
<p><del>|  <code>*-高亮*</code>  |  <em>-高亮</em>  |</del> ❌<br>
<del>| <code>*=吐槽系*</code> | <em>=吐槽系</em> |</del> ❌</p>
<p><del>如此，我们便增加了 <em>_下划线</em> 和 <em>=高亮</em> 两种语法标识了。另外，在文章中，尤其是一些摘录和转载的文章中，我们需要做一些随笔，之前我们是使用 <code>&lt;div class=&quot;oh-essay&quot;&gt;...&lt;/div&gt;</code> 这种标签插入，如上表，我们也对其做了语法标识。</del></p>
<p>如上，所示，更改了一些语法标记，因为有的 Markdown 引擎中使用 <code>==高亮==</code> 来高亮文本，我们这里就用 <code>*=高亮*</code> 来表示，以做到在观感上统一。</p>
<p>另外，我们不再使用 <code>*=吐槽系*</code> 来表示个人在摘录或编辑中的个人想法展示，主要是由于在不支持当前语法标记的主题中，它只能以斜体展示，不容易和正文内容作区分。我们使用 <code>&gt;:: 吐槽系</code> 或 <code>&gt; :: 吐槽系</code> 来表示，如此在不支持的情况下，可以解析为引用样式，便于区分。</p>
<p>之前我们做了一些 snippet 进行 html 标签的插入，以实现以上效果，但是这就限定在了某些编辑器中，些许背离了纯文本输入的理念，以上小小的增强，使得我们可以任何文本编辑器中进行方便的文本输入。</p>
<pre tabindex="0"><code>&gt;:: 好吧，尽管它们只能在 `hugo-theme-virgo` 中才有效果 😅
&gt; ::好吧，尽管它们只能在 `hugo-theme-virgo` 中才有效果 😅
&gt; :: 好吧，尽管它们只能在 `hugo-theme-virgo` 中才有效果 😅
</code></pre><p>上述语法标记是等价的，会被解析为如下样式：</p>
<blockquote>
<p>:: 好吧，尽管它们只能在 <code>hugo-theme-virgo</code> 中才有效果 😅</p>
</blockquote>
<h3 id="代码块折叠">代码块折叠</h3>
<pre tabindex="0"><code class="language-__点击查看历史内容" data-lang="__点击查看历史内容">
在 Markdown 中，包裹代码块很方便。但有时候在博文中，我们可能引入较多的代码片段，这会导致正文内容的间断，所以，允许其进行折叠，可以在 `config.toml` 中，使用 `hasFoldAllCodeBlocks: true` 进行初始化。

既然已经可以折叠了，这里我们不妨用它再做一个更通用的折叠板（默认折叠），原理也很简单，利用 `lang` 判别。

如果其为 `_lang` 这种格式，则表示轻量级代码折叠 - 不换行；如果使用 `__lang` 则折叠板中内容会自动换行。
</code></pre><p><del>💡 在新精简版中，我们 <strong>不再支持</strong> 代码块折叠及折叠板功能。</del></p>
<p><code>&gt; 2024-12-03 14:52</code> 新的精简版（好嘛~）重新支持折叠版功能，使用方式不变，实现逻辑进一步优化 - 这里我们使用 Html 原生标签 <code>&lt;details&gt;</code> 来实现。</p>
<p>在 Markdown 中，我们只需要为代码块指定不同以 1 个下划线 <code>_</code> 或 2 个下划线 <code>__</code> 开头的标识即可，如 <code>_折叠代码块</code> 、 <code>__折叠引用块</code> 。</p>
<ul>
<li><code>_lang</code> 这种格式，表示折叠代码块 - 其内容不换行，其行为及样式和 <code>pre</code> 保持一致；</li>
<li><code>__lang</code> 这种格式，表示折叠引用块 - 内容换行，其行为及样式和 <code>blockquote</code> 基本保持一致。</li>
</ul>
<p>PS：关于字体大小，前者与代码块本身保持一致（<code>14px</code>）；后者则与正文内容保持一致（<code>16px</code>）。</p>
<p><code>&gt; 1、不带语言标识的代码块</code></p>
<pre tabindex="0"><code>@SpringBootApplication
public class Application {
    public static void main(String[] args) throws Exception {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre><p><code>&gt; 2、带语言标识的代码块</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Application</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Exception <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        SpringApplication<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">run</span><span style="color:#000;font-weight:bold">(</span>Application<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>&gt; 3、以 _ 开头的描述头（不要有空格），不会自动换行</code></p>
<pre tabindex="0"><code class="language-_折叠代码块" data-lang="_折叠代码块">
@SpringBootApplication
public class Application {
    public static void main(String[] args) throws Exception {     // 不会自动换行，这是一个类的主函数 main 呀~ 
        SpringApplication.run(Application.class, args);
    }
}
</code></pre><p><code>&gt; 4、以 __ 形状的描述头（不要有空格），会自动换行</code></p>
<pre tabindex="0"><code class="language-__折叠引用块" data-lang="__折叠引用块">
@SpringBootApplication
public class Application {
    public static void main(String[] args) throws Exception {     // 会自动换行，这是一个类的主函数 main 呀~ 
        SpringApplication.run(Application.class, args);
    }
}
</code></pre><h3 id="wiki-链接及图片语法渲染">Wiki 链接及图片语法渲染</h3>
<p>最近使用 Obsidian ，其使用的链接及图片格式为 Wiki 语法，如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>链接</td>
<td>![[assets/Pasted image 20231005135434.png|60]]</td>
</tr>
<tr>
<td>链接（带描述）</td>
<td>![[assets/Pasted image 20231005135451.png|116]]</td>
</tr>
<tr>
<td>图片</td>
<td>![[assets/Pasted image 20231005135507.png|120]]</td>
</tr>
<tr>
<td>图片（带尺寸）</td>
<td>![[assets/Pasted image 20231005135528.png|166]]</td>
</tr>
</tbody>
</table>
<p>Hugo 默认的 Markdown 引擎是不支持渲染这种语法的，我们这里做了一下增强，现在你可以畅快地使用 Obsidian 来编辑你的博客了。</p>
<blockquote>
<p>:: 图片和链接，好像 Wiki 的这种语法写起来更加简洁。其实，还是使用 <code>&lt;img&gt; </code> 标签的通用性更好些，不过许多软件的即时渲染又不支持，就很伤。</p>
</blockquote>
<h3 id="图片渲染相关">图片渲染相关</h3>
<p>在使用 Obsidian 或 Typora 自动插入图片时，自动插入的图片路径形式为 <code>assets/xxx.jpg</code> 等（无法通过设置使其插入路径为 <code>/assets/xxx.jpg</code> 的形式），Hugo 无法正确渲染访问路径，它在解析的时候，会生成有类似如下路径：
<code>http://localhost:1313/temp-%E8%B0%83%E8%AF%95%E6%96%87%E4%BB%B6/assets/baby.png</code> ，所以，我们对其遍历，为不以 <code>/</code> 开头的路径，添加 <code>/</code> ，以使其正确渲染。</p>
<h2 id="我的怎么写博客的">我的怎么写博客的</h2>
<p>在《[[一场疲惫的主题制作之旅]]》中，已经有了不少博客相关的碎碎念。这里，主要用来浅谈一下当前站点博客系统的搭建、编辑及部署相关的系列流程。</p>
<p>当前站点，使用 <a href="https://gohugo.io/">Hugo 静态博客生成系统</a> 驱动，部署在个人服务器上。事实上，你可以把生成的站点项目部署在任何可以被访问的地方（比如 <code>Github Page</code>），它本质上是一个包含了若干 <code>.html</code> 文件及相关静态资源的文件夹。</p>
<h3 id="准备篇">准备篇</h3>
<p>……</p>
<h3 id="搭建篇">搭建篇</h3>
<p>……</p>
<h3 id="编辑篇">编辑篇</h3>
<p>这里，我们以当前文章的创建及编辑过程为例。其中：</p>
<ul>
<li>✔️ 正在使用</li>
<li>❌ 已不使用</li>
</ul>
<blockquote>
<p>:: 怎么说呢？这个章节写的过于太细节了……好像…… 😅</p>
</blockquote>
<h4 id="-使用-vscode-编辑">❌ 使用 VSCode 编辑</h4>
<h5 id="创建文章">创建文章</h5>
<p>我们可以使用以下命令来创建文章：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>hugo new posts/how-do-i-blog/index.md	<span style="color:#998;font-style:italic"># 推荐</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 或</span>
</span></span><span style="display:flex;"><span>hugo new posts/how-do-i-blog.md			<span style="color:#998;font-style:italic"># 不推荐</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里我们使用第一条命令，该命令会自动生成如下目录层级下 <code>.md</code> 文件。</p>
<pre tabindex="0"><code>content
├── posts
│   ├── how-do-i-blog
│   │   ├── imgs
│   │   │   └── 1aa09c580e674b09e82c722a3689d280012f2ae6e1700e924deeef558347d91a.png
│   │   └── index.md
</code></pre><p><strong>为什么不直接使用 <code>how-do-i-blog.md</code> ，而使用 <code>how-do-i-blog/index.md</code> ？</strong></p>
<p>正如上述目录层级中所反映的，如此方便我们把当前文件所需要的资源（如图片 imgs ）都放在当前文章的层级下，方便管理。</p>
<p>这样做还有额外的好处，我们将在后面 [[#插入图片]] 的部分进一步说明。</p>
<h5 id="插入图片">插入图片</h5>
<p>在文章中插入图片是一个相对高频的操作。在第三方的博客平台中，一般来说直接复制图片并粘贴到要插入的位置就可以了，很方便。而编辑 <code>.md</code> 文件，插入图片就稍微麻烦一些。</p>
<p>我们通过 <code>![图片名称](地址链接)</code> 在文章中插入图片，默认情况下，你需要经过：</p>
<pre tabindex="0"><code>1. 搜索图片
2. 另存图片到本地
3. 编辑 `![图片名称](地址链接)` 引用
……
</code></pre><p><strong>很繁琐！</strong></p>
<p>而且还不能控制图片的‘显示’尺寸，需要插入图片数量过多的时候，简直就是一种折磨了。</p>
<p><strong>有没有一种更好的方式来插入图片呢？</strong></p>
<p>很幸运，有！</p>
<p>我平时是使用 VSCode 来管理站点内容和编辑 <code>.md</code> 文件的，其中有一款插件很好地解决了这个问题。</p>
<p>![[assets/Pasted image 20230526102347.png]]</p>
<p>它提供了丰富的自定义设置选项，这里主要用到以下几种：</p>
<ul>
<li>Markdown-image › Base: File Name Format ，设置为 <code>${hash}</code> ，当然有其它各种格式可选组合；</li>
<li>Markdown-image › Base: Image Width ，设置为 <code>400</code> ，默认宽度设为 <code>400px</code> ；</li>
<li>Markdown-image › Local: Path ，设置为 <code>./imgs</code> ，生成的图片放在当前文章同级目录下的 <code>imgs</code> 文件夹中。</li>
</ul>
<blockquote>
<p>这也是上文中我们推荐使用 <code>hugo new posts/how-do-i-blog/index.md</code> 命令来生成文章的原因之一。</p>
</blockquote>
<p>使用该插件，你只需要复制所需要图片（本地或网络图片），并通过其提供的粘贴方式（右键选择）插入到位置即可。如此，你的 <code>.md</code> 文件中，就会插如下内容：</p>
<pre tabindex="0"><code>&lt;img alt=&#34;picture 3&#34; src=&#34;imgs/30737f6467ed6269eed8911b8a915f47b9fed706b8f892efd3271d9b6a76181c.png&#34; width=&#34;400&#34; /&gt;  
</code></pre><p>它会被渲染成下面这张图片，是不是很方便！</p>
<p>![[assets/Pasted image 20230526102356.png]]</p>
<p><strong>它的原理是什么？</strong></p>
<p>它会读取你剪切板中刚刚复制的图片数据，在你粘贴的时候，重新生成一份拷贝，并在 <code>.md</code> 文件中，插入对应的图片格式，并引用。真的很方便！🎉</p>
<h5 id="其他插件">其他插件</h5>
<p><a href="https://github.com/cyberbiont/vscode-open-in-typora">cyberbiont/vscode-open-in-typora: open Markdown files from VSCode in Typora</a></p>
<p>![[assets/Pasted image 20230815170141.png]]</p>
<p>在 VSCode 中使用 Typora 打开当前 Markdown 文件。</p>
<h4 id="-使用-typora-编辑">❌ 使用 Typora 编辑</h4>
<p>创建文章不是 Typora 的强项，光是手写 Front Matter 都让人受不了，就老老实实地用 [[#创建文章]] 章节中的命令创建好文章，再用 Typora 编辑就好。（这也是不支持第三方插件的坏处了，什么问题你只能等着作者去解决。相对来说，Obsidian 就不存在这个问题，它支持类似于 Snippet 的插件扩展。）</p>
<blockquote>
<p>:: 现在的编辑操作就是使用 Typora 完成的。 😄</p>
</blockquote>
<p><strong>之前的 VSCode 使用的不是很爽吗？为什么切换为 Typora 了呢？</strong></p>
<p>VSCode 确实很爽，到目前为止，我也经常使用它。切换到 Typora 的原因也很简单，家里的电脑性能不行，新的主机配置还在纠结中……</p>
<p>更多原因可以查看 [[一款 Typora 主题]] 中的描述。</p>
<blockquote>
<p>PS： VSCode 真的是一款非常优秀的编辑器，插件丰富且优质，可扩展性强，可轻可重。</p>
</blockquote>
<p><strong>使用 Typora 的感觉怎么样？</strong></p>
<p>很好！如 [[一款 Typora 主题]] 中所描述的那样，配合自己制作的主题（由站点样式适配），基本上实现了所见即所得的编辑。另外，Typora 本身集成了许多 Markdown 相关的快捷键，很直观也很好用，尤其是当你专注于编写内容的时候。</p>
<p>它还有‘专注模式’和‘打字机模式’，很舒心。</p>
<p>其内置的图片插入功能也不错，基本上和 [[#插入图片]] 章节中的实现是相同的，原理没有探究。怎么说呢，Typora 上的相对来说，更加符合日常的编辑逻辑，还贴心地增加了可以缩放图片的选项，最最重要的还是‘所见即所得’，你可以实时看到你的图片。</p>
<h4 id="-使用-obsidian-编辑">✔️ 使用 Obsidian 编辑</h4>
<p>支持扩展的编辑器是可以不断进化的，比如 Emacs、Vi/Vim 等。</p>
<p>上面说了，Typora 是不容易扩展的（不支持），这就限制了使用，要么牵就，要么离开…… 尝试了几个软件之后，Obsidian 可以说是相当不错的管理软件了，稍微‘调教’之后，就相当顺手了。</p>
<p>Obsidian 也是所见即所得的编辑模式，有非常丰富的三方插件，如键位映射、图片缩放/清理、表格插入/编辑等功能都可以很方便的得到实现。</p>
<p>……</p>
<p>为了更方便地显示图片及适应 [[如何使用 hugo-theme-virgo 主题]] 中关于 [[#Wiki 链接及图片语法渲染]] 的兼容，重新组织了博客层级，如下：</p>
<pre tabindex="0"><code>C:\USERS\JACK\APPDATA\ROAMING\SITE\CONTENT
│  A Simple Bookmark Copying.md
│  Ajax.md
│  C.md
│  Canvas.md
│  CPU 是如何制造出来的.md
│  CPU 缓存是什么.md
│  CSS 中的动效.md
│  Emacs Lisp.md
│  Emojings.md
│  Git.md
│  GTD 管理系统.md
│  Java 那些事儿.md
│
├─assets
│      3b5d12f26d9d00dc2b021d097ff8c34.jpg
│      4.gif
│      Pasted image 20230525155800.png
│      Pasted image 20230817094853.png
│      vim.gif
│
└─snippets
        frontmatter.md
        longitudinal.md
        more.md
        timestamp.md
</code></pre><p>并且，使用 <code>tags</code> 标签来分类博文，而不是之前的 <code>categories</code> 分类。</p>
<h5 id="创建文章-1">创建文章</h5>
<p>如上面的博客层级所示，我用 <code>content</code> 目录作为 Obsidian 的根目录，如此，Obsidian 相关的所有配置（如插件、主题、设置等） <code>.obsidian</code> 文件夹都使用 Git 统一管理。</p>
<blockquote>
<p>💡 <code>.obsidian</code> 默认位于 Obsidian 仓库的根目录。</p>
</blockquote>
<p>创建文章很简单，直接使用 Obsidian 提供的相关创建逻辑就行了。需要注意的是，如果你的博文也想用 Hugo 进行管理的话，就需要在博文头部添加相应的信息。如：</p>
<pre tabindex="0"><code>---
title: 我是怎么写博客的
aliases: []
tags:
  - Hugo
date: 2023-05-26 
time: 10:21
---
</code></pre><p>其中， <code>title</code> 和 <code>date</code> 是必须的，Hugo 需要使用其提供的信息进行渲染。</p>
<p>如果你使用 <code>hugo new</code> 命令去生成 <code>.md</code> 文件的话，那么你只需要设置 Hugo 相关的 <code>archetypes/default.md</code> ，如：</p>
<pre tabindex="0"><code>---
title: &#34;{{ replace .Name &#34;-&#34; &#34; &#34; | title }}&#34;
aliases: 
tags: [_Misc]
date: {{ .Date | time.Format &#34;2006-01-02&#34; }}
time: {{ .Date | time.Format &#34;15:04&#34; }}
---
</code></pre><p>然后，运行如 <code>hugo new my-post-name.md</code> 之类的命令就可以了。</p>
<p>当然，Obsidan 本身也是支持插入模板的，如 Templater 模板插件，你写好模板，放在相应文件夹下（如 <code>snippets/frontmatter</code>） ，运行插入命令即可，如：</p>
<pre tabindex="0"><code>---
title:  &lt;% tp.file.title %&gt;
aliases: 
tags:
  - _Misc
date:  &lt;% tp.date.now() %&gt;
time:  &lt;% tp.date.now(&#34;HH:mm&#34;) %&gt;
---
</code></pre><h5 id="插入图片-1">插入图片</h5>
<p>Obsidian 的插入图片很方便，你只需要像文本一样粘贴进来就好了。图片会自动上传到设置好的目录，可以是相对于当前文件的相对位置，也可以相对于仓库根目录的绝对位置。</p>
<p>图片插入后，默认是 WIKI 语法的，如 <code>![[path/to/img]]</code> ，可以在设置中修改为常用 Markdown 语法的。当然，如果你使用  <a href="https://github.com/loveminimal/hugo-theme-virgo">hugo-theme-virgo</a> 主题的话，就不用担心，它支持 WIKI 语法的图片和链接的渲染。</p>
<p>![[assets/Pasted image 20231026173226.png]]</p>
<p>这个插件，可以让你方便的调整图片尺寸，如按着 ALT 键滚动缩放。</p>
<h5 id="插入表格">插入表格</h5>
<blockquote>
<p>:: <strong>目前新版本的 Obsidian 已经完美支持表格操作，便捷好用，终于可以完全抛弃 Typora 了！</strong></p>
</blockquote>
<p><del>这方面，目前没有遇到比 Typora 做的更好的了。</del> 当然，借助下面这个插件，可以实现类似 Typora 表格插入和编辑的体验：</p>
<p>![[assets/Pasted image 20231026173536.png]]</p>
<p>另外，这个插件是没有上传到官方插件仓库的，但可以借助 Obsidian42-Bart 这个插件去引入，也很方便。</p>
<p>![[assets/Pasted image 20231026173648.png]]</p>
<p>不得不说，支持第三方扩展的软件，才会更有生命力！</p>
<h3 id="渲染篇">渲染篇</h3>
<p>详见 [[#标记语法增强]] 章节。</p>
<h3 id="部署篇">部署篇</h3>
<p>当你想部署你的站点内容到托管平台时，你可能会经过以下步骤：</p>
<pre tabindex="0"><code>1. 执行 `hugo` 命令，生成站点内容，默认放在站点根目录的 `public` 文件夹中；
2. 复制内容包，上传到托管平台；
……
</code></pre><p>如果，只操作一次的话，不是很复杂，但如果，你的内容更新比较频繁，那就有些烦扰了。内容包的部署方式有很多，各有优缺。</p>
<h4 id="脚本部署">脚本部署</h4>
<p>我们这里，使用脚本部署，一次性配置之后，每次部署只需要执行一条简单的命令即可。分享出来，供大家参考使用。</p>
<p>我们的站点目录如下所示：</p>
<pre tabindex="0"><code>.
├── config.toml
├── content
│   ├── about
│   ├── archive.md
│   ├── _index.md
│   ├── nav
│   ├── posts
│   └── search.md
├── package.json
├── README.md
├── resources
│   └── _gen
├── scripts
│   ├── deploy.sh
│   └── update.sh
</code></pre><p><code>&gt; 2023-09-05 22:41 最新</code> - 完全可以做为唯一的部署脚本 ！它对站点内容的跟踪是完备的，当前环境下，只会在首次部署的时候进行全量更新，后续会自动基于 Git 的更新记录进行增量式更新，体验相当不错。</p>
<p>其中， <code>scripts/deploy.sh</code> 便是我们定义的部署脚本，其内容如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 部署博客到指定的仓库</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Deploy posts to special repo.</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 配置 Configurations</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 自定义 `REPO_DEPLOYED` 为所要部署仓库</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">REPO_DEPLOYED</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;jack@aituyaa.com:/home/jack/.repo/site.git&#34;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># rm -rf &#34;public/CNAME&#34; &amp;&amp; cp -r &#34;CNAME&#34; &#34;public/&#34; # Fix potential error - Recovery `CNAME` before deploy.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 判断是否存在 public</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># 判断是否已经存在与 site 同级的 .temp 文件夹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> ! -d <span style="color:#d14">&#34;../.temp&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># ^ 若不存在，直接复制 public 为 ../.temp ，进入该目录，初始化，强制推送至指定的远程仓库</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp not exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>        cp -r <span style="color:#d14">&#34;public&#34;</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt;[DONE] copy public to .temp. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        git init
</span></span><span style="display:flex;"><span>        git add .
</span></span><span style="display:flex;"><span>        git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>        git remote add origin <span style="color:#008080">$REPO_DEPLOYED</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># git remote add origin https://github.com/loveminimal/loveminimal.github.io.git</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># git push -f origin master:main</span>
</span></span><span style="display:flex;"><span>        git push -f origin master
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">else</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># ^ 若存在，则进入 ../.temp 目录，判断该仓库是否已初始化（包含 .git ）</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;.git&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic"># ^^ 若存在 .git ，则备份 .git ，并在处理 .temp 后，恢复它</span>
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[42m &gt;&gt;&gt; copying.... \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            mv <span style="color:#d14">&#34;.git&#34;</span> <span style="color:#d14">&#34;../.git.bak&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic"># 此处，对于 .temp 处理的目的是为了绝对保持其与 site/public 文件的一致性（无论增删）</span>
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">cd</span> ..
</span></span><span style="display:flex;"><span>            rm -rf .temp
</span></span><span style="display:flex;"><span>            cp -r <span style="color:#d14">&#34;site/public&#34;</span> <span style="color:#d14">&#34;.temp&#34;</span>
</span></span><span style="display:flex;"><span>            mv <span style="color:#d14">&#34;.git.bak&#34;</span> <span style="color:#d14">&#34;.temp/.git&#34;</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">cd</span> .temp
</span></span><span style="display:flex;"><span>            git add .
</span></span><span style="display:flex;"><span>            git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>            git push -f origin master
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic"># ^^ 若不存在 .git ，初始化，强制推送至指定的远程仓库</span>
</span></span><span style="display:flex;"><span>            git init
</span></span><span style="display:flex;"><span>            git add .
</span></span><span style="display:flex;"><span>            git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>            git remote add origin <span style="color:#008080">$REPO_DEPLOYED</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic"># git remote add origin https://github.com/loveminimal/loveminimal.github.io.git</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic"># git push -f origin master:main</span>
</span></span><span style="display:flex;"><span>            git push -f origin master
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[42m &gt;&gt;&gt;[DONE] Update. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;../site&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在站点根目录下，运行 <code>source scripts/deploy.sh</code> 就可以静待站点部署完成了。</p>
<blockquote>
<p>💡 <strong>注意修改 <code>REPO_DEPLOYED</code> 为你自己的部署仓库！</strong></p>
</blockquote>
<h4 id="命令简化">命令简化</h4>
<p>使用 <code>source scripts/deploy.sh</code> 还是有点太复杂了？有如下限制：</p>
<ul>
<li>需要进行到站点根目录才可以运行它；</li>
<li>部署后，站点内的内容包并没得到清理。</li>
</ul>
<p>哈，你只需要多加几条命令即可，如下：</p>
<pre tabindex="0"><code>cd ~/AppData/Roaming/site &amp;&amp; rm -rf public &amp;&amp; hugo &amp;&amp; source scripts/deploy.sh &amp;&amp; rm -rf public
</code></pre><p>如此，无论当前你在那一种路径，都会：</p>
<ol>
<li>自动进入站点根目录（此处是 <code>site</code>）；</li>
<li>删除站点下旧的 <code>public</code> （如果有的话）；</li>
<li>根据当前内容生成新的 <code>public</code> 内容包；</li>
<li>执行部署脚本，发布到对应托管平台；</li>
<li>清理掉生成的 <code>public</code> 内容包。</li>
</ol>
<p>Emm… 还是长啊，每次都要键入这么长，太麻烦了，怎么办？</p>
<p>那么你就需要了解一些关于 bash alias 方面的知识了，如下所示，在当前用户家目录下，创建 <code>.bash_aliases</code> 文件（若无），并添加如下内容：</p>
<pre tabindex="0"><code>alias ssd=&#34;cd ~/AppData/Roaming/site &amp;&amp; rm -rf public &amp;&amp; hugo &amp;&amp; source scripts/deploy.sh &amp;&amp; rm -rf public&#34;
</code></pre><p>保存后，在用户家目录下，运行 <code>source .bashrc</code> 命令使 <code>.bash_aliases</code> 中的别名生效。</p>
<p>OK，现在，当你想部署站点的时候，你只需要运行键入 <code>ssd</code> ，回车即可完成部署。</p>
<p><strong>‘用户家目录’是什么？</strong></p>
<p>在 Windows 下，有两个家目录：</p>
<ul>
<li>用户家目录，如 <code>C:\Users\jack</code> ，一些软件的默认配置会放在该目录下；</li>
<li>用户漫游家目录，如 <code>C:\Users\jack\AppData\Roaming</code> ，另一些软件的配置又会放在这个目录下。</li>
</ul>
<p>😅 微软的东西真的有点混乱哈。</p>
<p>如果，你使用的是 GNU/Linux 系统，那么家目录就只有一个喽，如 <code>/home/jack</code> 。</p>
<p>❗❗❗😅 <strong>记一次踩坑……</strong></p>
<p>原来的域名 walkssi.com 废弃了，启用了新的域名 aituyaa.com 。不久前老域名到期之后，腾讯云那边的 DNS 解析服务就停止了，但是公司主机上的 <code>.temp</code> 文件夹（上方部署脚本中生成的）已经存在，这导致一键部署的时候总是提示 <code>ssh: connect to host walkssi.com port 22: Connection timed out</code> …… 搞的自己在腾讯云域名解析那里弄了好久，再跑到服务器上检查 Nginx 设置…… blablabla……</p>
<p>答案是：更换了域名之后，如果 <code>.temp</code> 文件夹存在，就要先删除它，因为它是一个包含 <code>.git</code> 的完备追踪文件夹，其会延用旧有的域名信息。</p>
<h3 id="附录">附录</h3>
<h4 id="-废弃的部署脚本">❌ 废弃的部署脚本</h4>
<p>最初版本的 <code>scripts/deploy.sh</code> 脚本，其内容如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># deploy.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Deploy posts to `loveminimal.github.io`</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 检测是否存在 .temp 文件夹，若存在，先移除 </span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;../.temp&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[31m &gt;&gt;&gt; .temp exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>    rm -rf <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; ... \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp has been removed. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp not exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 如果你是部署到 GitHub ，并绑定了域名，那你可能需要启用该行，以</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 保证其正确的指向</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># rm -rf &#34;public/CNAME&#34; &amp;&amp; cp -r &#34;CNAME&#34; &#34;public/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 拷贝内容包 public 到一个临时文件夹 .temp ，并</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 用 git 初始化管理该它</span>
</span></span><span style="display:flex;"><span>    cp -r <span style="color:#d14">&#34;public&#34;</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">pwd</span>
</span></span><span style="display:flex;"><span>    git init
</span></span><span style="display:flex;"><span>    git add .
</span></span><span style="display:flex;"><span>    git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 添加远程库，引得我们使用的是个人服务器的仓库地址，如果</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 你是托管在 GitHub 上，那么连接的对应的远程库即可 - &lt;YOUR_USERNAME&gt;.github.io</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 如果你是在 GitHub ‘政治正确’后创建的库，其默认分支为 main, 那你</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 需要 master:main 而不是 master</span>
</span></span><span style="display:flex;"><span>    git remote add origin jack@ovirgo.com:/home/jack/.repo/site.git
</span></span><span style="display:flex;"><span>    git push -f origin master
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># git remote add origin https://github.com/loveminimal/loveminimal.github.io.git</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># git push -f origin master:main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 清除临时文件夹</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> ..
</span></span><span style="display:flex;"><span>    rm -rf <span style="color:#d14">&#34;.temp&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic"># 返回站点目录</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;site&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>初看，上述脚本初看可能有些混乱，但其实，理论上你只需要：</p>
<ul>
<li>更改远程仓库地址；</li>
<li>更改站点目录，即可。</li>
</ul>
<hr>
<p><code>&gt; 2023-09-05 11:53 更新 - 添加增量更新脚本</code></p>
<p>随着博文数量的增加，我们使用 <code>deploy.sh</code> 全量更新的话，时间也会随之变长。单纯的文字还好，但站点难免会引入外部的静态资源（图片、音频等），如此‘等待’就成了一个问题。所以，就有了 <code>update.sh</code> ，如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#!/bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># update.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Deploy posts to `loveminimal.github.io`</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># -------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> ! -d <span style="color:#d14">&#34;../.temp&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp not exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>    mkdir <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; ... \e[0m&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp has been created. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">else</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> -e <span style="color:#d14">&#34;\e[32m &gt;&gt;&gt; .temp exited. \e[0m&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;public&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># rm -rf &#34;public/CNAME&#34; &amp;&amp; cp -r &#34;CNAME&#34; &#34;public/&#34; # Fix potential error - Recovery `CNAME` before deploy.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cp -r <span style="color:#d14">&#34;public/.&#34;</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;../.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">pwd</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># 该仓库没有初始化，初始化该仓库，并推送</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># 仓库已初始化，仅推送增量更新</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> -d <span style="color:#d14">&#34;.git&#34;</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>        git add .
</span></span><span style="display:flex;"><span>        git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>        git push -f origin master
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>        git init
</span></span><span style="display:flex;"><span>        git add .
</span></span><span style="display:flex;"><span>        git commit -m <span style="color:#d14">&#34;Posts update.&#34;</span>
</span></span><span style="display:flex;"><span>        git remote add origin jack@walkssi.com:/home/jack/.repo/site.git
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># git remote add origin https://github.com/loveminimal/loveminimal.github.io.git</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic"># git push -f origin master:main</span>
</span></span><span style="display:flex;"><span>        git push -f origin master
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> ..
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># rm -rf &#34;.temp&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">cd</span> <span style="color:#d14">&#34;site&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>它保留了临时文件夹的仓库跟踪，使得我们只需要提交增量更新即可，极大的缩小了仓库更新的时间。</p>
<p>当然，这样也会存在一个问题，就是当你删除了某些静态文件，如图片等，仓库是无法追踪到的，它只能知道你增加了什么。幸运的是，这个场景本身很少出现，你并需要关注它。当然，如果你实在介意，你可以执行以下操作中的一个就可以实现全量更新了：</p>
<ul>
<li>手动删除 <code>.temp</code> 文件夹；</li>
<li>或者，你可以直接执行前面的 <code>deploy.sh</code> 脚本；</li>
<li>或者，你可以使用下面这个最新的 <code>update.sh</code> 脚本，它会严格保持修改前后文件的一致性，性能介于 <code>deploy.sh</code> 和旧的 <code>update.sh</code> 之间，比后者稍慢一点点（配置中等主机下几乎相同），但比前者快出非常非常多。</li>
</ul>
<blockquote>
<p>💡 事实上，你完全可以用下面这个最新（<code>2023-09-05 22:41</code>）的 <code>deploy.sh</code> 做为唯一的部署脚本（<strong>推荐</strong>）！</p>
</blockquote>
<h2 id="结语">结语</h2>
<p>制作主题，对‘强迫症’来说，真的是一件挺‘辛苦’的事情，或者说是‘痛并快乐着’ ？！</p>
    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=">
            

        </a>

        
        <a href="/about" target="_blank">
            
            将喜欢的一切留在身边，这便是努力的意义
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">🕊️</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.69); 
                backdrop-filter: saturate(180%) blur(6px);
            
            "></div>
    </body>
</html>
